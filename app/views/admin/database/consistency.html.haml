- content_for :title, _("Database consistency")

.wrapper.margin-top-m

  = render partial: "header"

  .row.content-wrapper.min-height-xl.min-width-full.straight-top
    - if @missing_references.empty?
      .row.margin-top-l.padding-horizontal-m
        .row
          .headline-l.float-left
            = _("All correct")
            %i.icon-check-sign.icon-size-s

    - @missing_references.each do |h|
      .row.margin-top-l.padding-horizontal-m
        .row
          .headline-l
            = h[:values].size
            = "%s with missing %s" % [h[:from], h[:to]]
            = " (polymorphic association)" if h[:polymorphic]
            = " (through %s join table)" % h[:join_table] if h[:join_table]

          - case h[:dependent]
          - when :delete, :delete_all, :destroy, :nullify
            = link_to admin_fix_consistency_path(from: h[:from], to: h[:to], dependent: h[:dependent]), method: :post, class: "button red" do
              = "%s on the database" % h[:dependent].to_s.humanize
          - else
            -#no action#

        .row.emboss.margin-vertical-s
          - h[:values].each do |value|
            .row.line
              .line-info.red
              .col1of1.line-col
                = value.inspect
